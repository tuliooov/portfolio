"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/webhooks";
exports.ids = ["pages/api/webhooks"];
exports.modules = {

/***/ "faunadb":
/*!**************************!*\
  !*** external "faunadb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("faunadb");

/***/ }),

/***/ "stripe":
/*!*************************!*\
  !*** external "stripe" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stripe");

/***/ }),

/***/ "(api)/./src/pages/api/_lib/manageSubscription.ts":
/*!**************************************************!*\
  !*** ./src/pages/api/_lib/manageSubscription.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"saveSubscription\": () => (/* binding */ saveSubscription)\n/* harmony export */ });\n/* harmony import */ var _service_fauna__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../service/fauna */ \"(api)/./src/service/fauna.ts\");\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! faunadb */ \"faunadb\");\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(faunadb__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _service_stripe__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../service/stripe */ \"(api)/./src/service/stripe.ts\");\n\n\n\nconst saveSubscription = async (subscriptionId, customerId, createdAction = false)=>{\n    const userRef = await _service_fauna__WEBPACK_IMPORTED_MODULE_0__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Select(\"ref\", faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Get(faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Match(faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Index(\"users_by_stripe_customer_id\"), customerId))));\n    const subscription = await _service_stripe__WEBPACK_IMPORTED_MODULE_2__.stripe.subscriptions.retrieve(subscriptionId);\n    const subscriptionData = {\n        id: subscription.id,\n        userId: userRef,\n        status: subscription.status,\n        priceId: subscription.items.data[0].price.id\n    };\n    if (createdAction) {\n        await _service_fauna__WEBPACK_IMPORTED_MODULE_0__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Create(faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Collection(\"subscriptions\"), {\n            data: subscriptionData\n        }));\n    } else {\n        await _service_fauna__WEBPACK_IMPORTED_MODULE_0__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Replace(faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Select(\"ref\", faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Get(faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Match(faunadb__WEBPACK_IMPORTED_MODULE_1__.query.Index(\"subscription_by_id\"), subscriptionId))), {\n            data: subscriptionData\n        }));\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL19saWIvbWFuYWdlU3Vic2NyaXB0aW9uLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQThDO0FBQ1Y7QUFDWTtBQUV6QyxNQUFNSSxnQkFBZ0IsR0FBRyxPQUM1QkMsY0FBc0IsRUFDdEJDLFVBQWtCLEVBQ2xCQyxhQUFhLEdBQUcsS0FBSyxHQUNwQjtJQUNELE1BQU1DLE9BQU8sR0FBRyxNQUFNUix1REFBVyxDQUM3QkUsaURBQVEsQ0FDSixLQUFLLEVBQ0xBLDhDQUFLLENBQ0RBLGdEQUFPLENBQ0hBLGdEQUFPLENBQUMsNkJBQTZCLENBQUMsRUFDdENJLFVBQVUsQ0FDYixDQUNKLENBQ0osQ0FDSjtJQUVELE1BQU1PLFlBQVksR0FBRyxNQUFNViwwRUFBNkIsQ0FBQ0UsY0FBYyxDQUFDO0lBRXhFLE1BQU1XLGdCQUFnQixHQUFHO1FBQ3JCQyxFQUFFLEVBQUVKLFlBQVksQ0FBQ0ksRUFBRTtRQUNuQkMsTUFBTSxFQUFFVixPQUFPO1FBQ2ZXLE1BQU0sRUFBRU4sWUFBWSxDQUFDTSxNQUFNO1FBQzNCQyxPQUFPLEVBQUVQLFlBQVksQ0FBQ1EsS0FBSyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUNDLEtBQUssQ0FBQ04sRUFBRTtLQUUvQztJQUVELElBQUdWLGFBQWEsRUFBQztRQUNiLE1BQU1QLHVEQUFXLENBQ2JFLGlEQUFRLENBQ0pBLHFEQUFZLENBQUMsZUFBZSxDQUFDLEVBQzdCO1lBQUVvQixJQUFJLEVBQUVOLGdCQUFnQjtTQUFFLENBQzdCLENBQ0o7S0FDSixNQUFJO1FBQ0QsTUFBTWhCLHVEQUFXLENBQ2JFLGtEQUFTLENBQ0xBLGlEQUFRLENBQ0osS0FBSyxFQUNMQSw4Q0FBSyxDQUNEQSxnREFBTyxDQUNIQSxnREFBTyxDQUFDLG9CQUFvQixDQUFDLEVBQzdCRyxjQUFjLENBQ2pCLENBQ0osQ0FDSixFQUNEO1lBQUVpQixJQUFJLEVBQUVOLGdCQUFnQjtTQUFFLENBQzdCLENBQ0o7S0FDSjtDQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHVsaW9fcG9ydGZvbGlvLy4vc3JjL3BhZ2VzL2FwaS9fbGliL21hbmFnZVN1YnNjcmlwdGlvbi50cz85MWFlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGZhdW5hIH0gZnJvbSBcIi4uLy4uLy4uL3NlcnZpY2UvZmF1bmFcIlxuaW1wb3J0IHsgcXVlcnkgYXMgcSB9IGZyb20gJ2ZhdW5hZGInXG5pbXBvcnQgeyBzdHJpcGUgfSBmcm9tIFwiLi4vLi4vLi4vc2VydmljZS9zdHJpcGVcIlxuXG5leHBvcnQgY29uc3Qgc2F2ZVN1YnNjcmlwdGlvbiA9IGFzeW5jIChcbiAgICBzdWJzY3JpcHRpb25JZDogc3RyaW5nLFxuICAgIGN1c3RvbWVySWQ6IHN0cmluZyxcbiAgICBjcmVhdGVkQWN0aW9uID0gZmFsc2UsXG4pID0+IHtcbiAgICBjb25zdCB1c2VyUmVmID0gYXdhaXQgZmF1bmEucXVlcnkoXG4gICAgICAgIHEuU2VsZWN0KFxuICAgICAgICAgICAgJ3JlZicsXG4gICAgICAgICAgICBxLkdldChcbiAgICAgICAgICAgICAgICBxLk1hdGNoKFxuICAgICAgICAgICAgICAgICAgICBxLkluZGV4KCd1c2Vyc19ieV9zdHJpcGVfY3VzdG9tZXJfaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tZXJJZFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgKVxuICAgIClcblxuICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IGF3YWl0IHN0cmlwZS5zdWJzY3JpcHRpb25zLnJldHJpZXZlKHN1YnNjcmlwdGlvbklkKVxuXG4gICAgY29uc3Qgc3Vic2NyaXB0aW9uRGF0YSA9IHtcbiAgICAgICAgaWQ6IHN1YnNjcmlwdGlvbi5pZCxcbiAgICAgICAgdXNlcklkOiB1c2VyUmVmLFxuICAgICAgICBzdGF0dXM6IHN1YnNjcmlwdGlvbi5zdGF0dXMsXG4gICAgICAgIHByaWNlSWQ6IHN1YnNjcmlwdGlvbi5pdGVtcy5kYXRhWzBdLnByaWNlLmlkLFxuXG4gICAgfVxuXG4gICAgaWYoY3JlYXRlZEFjdGlvbil7XG4gICAgICAgIGF3YWl0IGZhdW5hLnF1ZXJ5KFxuICAgICAgICAgICAgcS5DcmVhdGUoXG4gICAgICAgICAgICAgICAgcS5Db2xsZWN0aW9uKCdzdWJzY3JpcHRpb25zJyksXG4gICAgICAgICAgICAgICAgeyBkYXRhOiBzdWJzY3JpcHRpb25EYXRhIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKVxuICAgIH1lbHNle1xuICAgICAgICBhd2FpdCBmYXVuYS5xdWVyeShcbiAgICAgICAgICAgIHEuUmVwbGFjZShcbiAgICAgICAgICAgICAgICBxLlNlbGVjdChcbiAgICAgICAgICAgICAgICAgICAgXCJyZWZcIixcbiAgICAgICAgICAgICAgICAgICAgcS5HZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBxLk1hdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHEuSW5kZXgoJ3N1YnNjcmlwdGlvbl9ieV9pZCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbklkXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIHsgZGF0YTogc3Vic2NyaXB0aW9uRGF0YSB9XG4gICAgICAgICAgICApXG4gICAgICAgIClcbiAgICB9XG59Il0sIm5hbWVzIjpbImZhdW5hIiwicXVlcnkiLCJxIiwic3RyaXBlIiwic2F2ZVN1YnNjcmlwdGlvbiIsInN1YnNjcmlwdGlvbklkIiwiY3VzdG9tZXJJZCIsImNyZWF0ZWRBY3Rpb24iLCJ1c2VyUmVmIiwiU2VsZWN0IiwiR2V0IiwiTWF0Y2giLCJJbmRleCIsInN1YnNjcmlwdGlvbiIsInN1YnNjcmlwdGlvbnMiLCJyZXRyaWV2ZSIsInN1YnNjcmlwdGlvbkRhdGEiLCJpZCIsInVzZXJJZCIsInN0YXR1cyIsInByaWNlSWQiLCJpdGVtcyIsImRhdGEiLCJwcmljZSIsIkNyZWF0ZSIsIkNvbGxlY3Rpb24iLCJSZXBsYWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/_lib/manageSubscription.ts\n");

/***/ }),

/***/ "(api)/./src/pages/api/webhooks.ts":
/*!***********************************!*\
  !*** ./src/pages/api/webhooks.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"config\": () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _service_stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../service/stripe */ \"(api)/./src/service/stripe.ts\");\n/* harmony import */ var _lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_lib/manageSubscription */ \"(api)/./src/pages/api/_lib/manageSubscription.ts\");\n\n\nasync function buffer(readable) {\n    const chucks = [];\n    for await (const chuck of readable){\n        chucks.push(typeof chuck === \"string\" ? Buffer.from(chuck) : chuck);\n    }\n    return Buffer.concat(chucks);\n}\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nconst relevantEvents = new Set([\n    \"checkout.session.completed\",\n    \"customer.subscription.created\",\n    \"customer.subscription.updated\",\n    \"customer.subscription.deleted\"\n]);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (async (req, res)=>{\n    if (req.method === \"POST\") {\n        const buf = await buffer(req);\n        const secret = req.headers[\"stripe-signature\"];\n        let event;\n        try {\n            event = _service_stripe__WEBPACK_IMPORTED_MODULE_0__.stripe.webhooks.constructEvent(buf, secret, process.env.STRIPE_WEBHOOK_SECRET);\n        } catch (error) {\n            return res.status(400).send(`Webhook error: ${error.message}`);\n        }\n        const { type  } = event;\n        if (relevantEvents.has(type)) {\n            try {\n                switch(type){\n                    case \"customer.subscription.created\":\n                    case \"customer.subscription.updated\":\n                    case \"customer.subscription.deleted\":\n                        const subscription = event.data.object;\n                        await (0,_lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__.saveSubscription)(subscription.id, subscription.customer.toString(), type === \"customer.subscription.created\");\n                        break;\n                    case \"checkout.session.completed\":\n                        const checkoutSession = event.data.object;\n                        await (0,_lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__.saveSubscription)(checkoutSession.subscription.toString(), checkoutSession.customer.toString(), true);\n                        break;\n                    default:\n                        throw new Error(\"Unhadled event.\");\n                }\n            } catch (error) {\n                return res.json({\n                    error: \"Webhook handler failed.\"\n                });\n            }\n        }\n        res.json({\n            received: true\n        });\n    }\n    res.setHeader(\"Allow\", \"POST\");\n    res.status(405).end(\"Mathod not allowed\");\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUNZLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ2dCLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQztDQUM1QyIsInNvdXJjZXMiOlsid2VicGFjazovL3R1bGlvX3BvcnRmb2xpby8uL3NyYy9wYWdlcy9hcGkvd2ViaG9va3MudHM/ZDNhNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSBcIm5leHRcIjtcbmltcG9ydCB7IFJlYWRhYmxlIH0gZnJvbSAnc3RyZWFtJ1xuaW1wb3J0IFN0cmlwZSBmcm9tIFwic3RyaXBlXCI7XG5pbXBvcnQgeyBzdHJpcGUgfSBmcm9tIFwiLi4vLi4vc2VydmljZS9zdHJpcGVcIjtcbmltcG9ydCB7IHNhdmVTdWJzY3JpcHRpb24gfSBmcm9tIFwiLi9fbGliL21hbmFnZVN1YnNjcmlwdGlvblwiO1xuXG5hc3luYyBmdW5jdGlvbiBidWZmZXIocmVhZGFibGU6IFJlYWRhYmxlKXtcbiAgICBjb25zdCBjaHVja3MgPSBbXVxuXG4gICAgZm9yIGF3YWl0IChjb25zdCBjaHVjayBvZiByZWFkYWJsZSl7XG4gICAgICAgIGNodWNrcy5wdXNoKFxuICAgICAgICAgICAgdHlwZW9mIGNodWNrID09PSAnc3RyaW5nJyA/IEJ1ZmZlci5mcm9tKGNodWNrKSA6IGNodWNrXG4gICAgICAgIClcbiAgICB9O1xuXG4gICAgcmV0dXJuIEJ1ZmZlci5jb25jYXQoY2h1Y2tzKVxufVxuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICAgIGFwaToge1xuICAgICAgICBib2R5UGFyc2VyOiBmYWxzZVxuICAgIH1cbn1cblxuY29uc3QgcmVsZXZhbnRFdmVudHMgPSBuZXcgU2V0KFtcbiAgICAnY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQnLFxuICAgICdjdXN0b21lci5zdWJzY3JpcHRpb24uY3JlYXRlZCcsXG4gICAgJ2N1c3RvbWVyLnN1YnNjcmlwdGlvbi51cGRhdGVkJyxcbiAgICAnY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQnXG5dKVxuXG5leHBvcnQgZGVmYXVsdCBhc3luYyAocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpID0+IHtcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAgIGNvbnN0IGJ1ZiA9IGF3YWl0IGJ1ZmZlcihyZXEpXG4gICAgICAgIGNvbnN0IHNlY3JldCA9IHJlcS5oZWFkZXJzWydzdHJpcGUtc2lnbmF0dXJlJ11cblxuICAgICAgICBsZXQgZXZlbnQ6IFN0cmlwZS5FdmVudFxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBldmVudCA9IHN0cmlwZS53ZWJob29rcy5jb25zdHJ1Y3RFdmVudChidWYsIHNlY3JldCwgcHJvY2Vzcy5lbnYuU1RSSVBFX1dFQkhPT0tfU0VDUkVUKVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYFdlYmhvb2sgZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeyB0eXBlIH0gPSBldmVudFxuXG4gICAgICAgIGlmKHJlbGV2YW50RXZlbnRzLmhhcyh0eXBlKSl7XG4gICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdjdXN0b21lci5zdWJzY3JpcHRpb24uY3JlYXRlZCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnY3VzdG9tZXIuc3Vic2NyaXB0aW9uLnVwZGF0ZWQnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2N1c3RvbWVyLnN1YnNjcmlwdGlvbi5kZWxldGVkJzpcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBldmVudC5kYXRhLm9iamVjdCBhcyBTdHJpcGUuU3Vic2NyaXB0aW9uXG5cbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2F2ZVN1YnNjcmlwdGlvbihcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5jdXN0b21lci50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9PT0gJ2N1c3RvbWVyLnN1YnNjcmlwdGlvbi5jcmVhdGVkJywgXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGVja291dFNlc3Npb24gPSBldmVudC5kYXRhLm9iamVjdCBhcyBTdHJpcGUuQ2hlY2tvdXQuU2Vzc2lvblxuXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhdmVTdWJzY3JpcHRpb24oXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja291dFNlc3Npb24uc3Vic2NyaXB0aW9uLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja291dFNlc3Npb24uY3VzdG9tZXIudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAgICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuaGFkbGVkIGV2ZW50LlwiKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oeyBlcnJvcjogJ1dlYmhvb2sgaGFuZGxlciBmYWlsZWQuJ30pXG4gICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgcmVzLmpzb24oeyByZWNlaXZlZDogdHJ1ZX0pXG4gICAgfSBcbiAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsICdQT1NUJylcbiAgICByZXMuc3RhdHVzKDQwNSkuZW5kKCdNYXRob2Qgbm90IGFsbG93ZWQnKVxufSJdLCJuYW1lcyI6WyJzdHJpcGUiLCJzYXZlU3Vic2NyaXB0aW9uIiwiYnVmZmVyIiwicmVhZGFibGUiLCJjaHVja3MiLCJjaHVjayIsInB1c2giLCJCdWZmZXIiLCJmcm9tIiwiY29uY2F0IiwiY29uZmlnIiwiYXBpIiwiYm9keVBhcnNlciIsInJlbGV2YW50RXZlbnRzIiwiU2V0IiwicmVxIiwicmVzIiwibWV0aG9kIiwiYnVmIiwic2VjcmV0IiwiaGVhZGVycyIsImV2ZW50Iiwid2ViaG9va3MiLCJjb25zdHJ1Y3RFdmVudCIsInByb2Nlc3MiLCJlbnYiLCJTVFJJUEVfV0VCSE9PS19TRUNSRVQiLCJlcnJvciIsInN0YXR1cyIsInNlbmQiLCJtZXNzYWdlIiwidHlwZSIsImhhcyIsInN1YnNjcmlwdGlvbiIsImRhdGEiLCJvYmplY3QiLCJpZCIsImN1c3RvbWVyIiwidG9TdHJpbmciLCJjaGVja291dFNlc3Npb24iLCJFcnJvciIsImpzb24iLCJyZWNlaXZlZCIsInNldEhlYWRlciIsImVuZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/webhooks.ts\n");

/***/ }),

/***/ "(api)/./src/service/fauna.ts":
/*!******************************!*\
  !*** ./src/service/fauna.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"fauna\": () => (/* binding */ fauna)\n/* harmony export */ });\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! faunadb */ \"faunadb\");\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(faunadb__WEBPACK_IMPORTED_MODULE_0__);\n\nconst fauna = new faunadb__WEBPACK_IMPORTED_MODULE_0__.Client({\n    secret: process.env.FAUNADB_KEY,\n    domain: \"db.us.fauna.com\"\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvc2VydmljZS9mYXVuYS50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0M7QUFFekIsTUFBTUMsS0FBSyxHQUFHLElBQUlELDJDQUFNLENBQUM7SUFDNUJFLE1BQU0sRUFBRUMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFdBQVc7SUFDL0JDLE1BQU0sRUFBRSxpQkFBaUI7Q0FDMUIsQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHVsaW9fcG9ydGZvbGlvLy4vc3JjL3NlcnZpY2UvZmF1bmEudHM/N2QwNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDbGllbnQgfSBmcm9tICdmYXVuYWRiJ1xuXG5leHBvcnQgY29uc3QgZmF1bmEgPSBuZXcgQ2xpZW50KHtcbiAgICBzZWNyZXQ6IHByb2Nlc3MuZW52LkZBVU5BREJfS0VZLFxuICAgIGRvbWFpbjogXCJkYi51cy5mYXVuYS5jb21cIixcbiAgfSk7XG4iXSwibmFtZXMiOlsiQ2xpZW50IiwiZmF1bmEiLCJzZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiRkFVTkFEQl9LRVkiLCJkb21haW4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/service/fauna.ts\n");

/***/ }),

/***/ "(api)/./src/service/stripe.ts":
/*!*******************************!*\
  !*** ./src/service/stripe.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"stripe\": () => (/* binding */ stripe)\n/* harmony export */ });\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! stripe */ \"stripe\");\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(stripe__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _package_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../package.json */ \"(api)/./package.json\");\n\n\nconst stripe = new (stripe__WEBPACK_IMPORTED_MODULE_0___default())(process.env.STRIPE_API_KEY, {\n    apiVersion: \"2020-08-27\",\n    appInfo: {\n        name: \"TulioAnnotation\",\n        version: _package_json__WEBPACK_IMPORTED_MODULE_1__.version\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvc2VydmljZS9zdHJpcGUudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUEyQjtBQUNpQjtBQUVyQyxNQUFNRSxNQUFNLEdBQUcsSUFBSUYsK0NBQU0sQ0FDNUJHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxjQUFjLEVBQzFCO0lBQ0lDLFVBQVUsRUFBRSxZQUFZO0lBQ3hCQyxPQUFPLEVBQUU7UUFDTEMsSUFBSSxFQUFFLGlCQUFpQjtRQUN2QlAsT0FBTztLQUNWO0NBQ0osQ0FDSiIsInNvdXJjZXMiOlsid2VicGFjazovL3R1bGlvX3BvcnRmb2xpby8uL3NyYy9zZXJ2aWNlL3N0cmlwZS50cz9kOGZhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTdHJpcGUgZnJvbSAnc3RyaXBlJ1xuaW1wb3J0IHsgdmVyc2lvbiB9IGZyb20gJy4uLy4uL3BhY2thZ2UuanNvbidcblxuZXhwb3J0IGNvbnN0IHN0cmlwZSA9IG5ldyBTdHJpcGUoXG4gICAgcHJvY2Vzcy5lbnYuU1RSSVBFX0FQSV9LRVksXG4gICAge1xuICAgICAgICBhcGlWZXJzaW9uOiAnMjAyMC0wOC0yNycsXG4gICAgICAgIGFwcEluZm86IHtcbiAgICAgICAgICAgIG5hbWU6ICdUdWxpb0Fubm90YXRpb24nLFxuICAgICAgICAgICAgdmVyc2lvblxuICAgICAgICB9LFxuICAgIH1cbikiXSwibmFtZXMiOlsiU3RyaXBlIiwidmVyc2lvbiIsInN0cmlwZSIsInByb2Nlc3MiLCJlbnYiLCJTVFJJUEVfQVBJX0tFWSIsImFwaVZlcnNpb24iLCJhcHBJbmZvIiwibmFtZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/service/stripe.ts\n");

/***/ }),

/***/ "(api)/./package.json":
/*!**********************!*\
  !*** ./package.json ***!
  \**********************/
/***/ ((module) => {

module.exports = JSON.parse('{"name":"tulio_portfolio","version":"0.1.0","private":true,"scripts":{"dev":"next dev","build":"next build","start":"next start","lint":"next lint"},"dependencies":{"@stripe/stripe-js":"^1.32.0","axios":"^0.27.2","faunadb":"^4.5.4","next":"12.1.4","next-auth":"^4.3.4","react":"18.0.0","react-dom":"18.0.0","react-icons":"^4.3.1","sass":"^1.49.10","stripe":"^8.214.0"},"devDependencies":{"@types/next-auth":"^3.15.0","@types/node":"^17.0.23","@types/react":"^17.0.43","eslint":"8.12.0","eslint-config-next":"12.1.4","typescript":"^4.6.3"}}');

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./src/pages/api/webhooks.ts"));
module.exports = __webpack_exports__;

})();